;/*!static/lib/webapp_new.js*/
window.onerror=function(e,t,a,n,i){var o=i;if(i&&i.stack)o=i.stack.toString();else if(arguments.callee){for(var r=[],s=arguments.callee.caller,p=3;s&&--p>0&&(r.push(s.toString()),s!==s.caller);)s=s.caller;o=r.join(" ")}-1==o.indexOf("WeixinJSBridge")&&page.apiPost("/Index/VoteLog/addJsLog",{content:"错误信息："+e+"\n当前URL："+location.href+"\n出错文件："+t+"\n出错行号："+a+"\n出错列号："+n+"\n错误详情："+o+"\n客户端版本:"+navigator.appCodeName+navigator.appVersion,title:e,url:location.href})},webapp.getUrlParam=function(e,t){if(t=t||location.href,this.urlArr=t.split("?"),this.urlArr.length<2)return"";this.paramsArr=this.urlArr[1].split("&");var a=[];for(var n in this.paramsArr)if(this._tmpArr=this.paramsArr[n].split("="),a[this._tmpArr[0]]=this._tmpArr[1]?this._tmpArr[1]:"",this._tmpArr[0]&&this._tmpArr[0]==e)return this._tmpArr[1];return a},webapp.ArrToUrlParam=function(e){if("object"==typeof e){var t="";for(var a in e)""!=t&&(t+="&"),t+=a+"="+e[a];return t}return!1},webapp.GetRequest=function(e){e=e&&-1!=e.indexOf("?")?e.substring(e.indexOf("?")):location.search;var t=new Object;if(-1!=e.indexOf("?"))for(var a=e.substr(1),n=a.split("&"),i=0;i<n.length;i++)t[n[i].split("=")[0]]=n[i].split("=")[1];return t},webapp.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},webapp.delQueStr=function(e,t){var a="";if(-1==t.indexOf("?"))return t;a=t.substr(t.indexOf("?")+1);var n="",o="";if(-1!=a.indexOf("&")){n=a.split("&");for(i in n)n[i].split("=")[0]!=e&&(o=o+n[i].split("=")[0]+"="+n[i].split("=")[1]+"&");return t.substr(0,t.indexOf("?"))+"?"+o.substr(0,o.length-1)}return n=a.split("="),n[0]==e?t.substr(0,t.indexOf("?")):t},webapp.share_url=function(e){var t=webapp.GetRequest();return e=webapp.delQueStr("session_id",e),webapp.isEmptyObject(t)?e=e+"?randomStr="+webapp.randomStn(32):(e=webapp.delQueStr("partner_id",e),e=webapp.delQueStr("randomStr",e),e=webapp.isEmptyObject(webapp.getUrlParam("",e))?e+"?randomStr="+webapp.randomStn(32):e+"&randomStr="+webapp.randomStn(32)),e},webapp.isMobile=function(e){return/^1\d{10}$/i.test(e)},webapp.isEmail=function(e){return/^[\w\-\.]+@[\w\-\.]+(\.\w+)+$/i.test(e)},webapp.getSessionId=function(){return this.getCookie(this.session_id_key)},webapp.setSessionId=function(e){webapp.setCookie(this.session_id_key,e)},webapp.success=function(e,t,a){e=e||2,a=a||1,setTimeout(function(){1==a?location.href=t:2==a?location.reload():3==a?window.history.go(-1):4==a&&(window.history.go(-1),location.reload())},1e3*e)},webapp.error=function(e,t){t=t||3e3,e=e||"发生错误啦",e=""==e?"发生错误啦":e,webapp.loading(3,e,t)},webapp.loading=function(e,t,a){var n='<div id="toastProm"><div class="weui-mask_transparent"></div><div class="weui-toast"><i class="weui-loading weui-icon_toast"></i><p class="weui-toast__content">'+(t||"加载中")+"</p></div></div>",i='<div id="toastProm"><div class="weui-mask_transparent"></div><div class="weui-toast"><i class="weui-icon-success-no-circle weui-icon_toast"></i><p class="weui-toast__content">'+(t||"已完成")+"</p></div></div>",o='<div id="toastProm"><div class="weui-mask_transparent"></div><div class="weui-toast error-toast p-five"><p style="display: inline-block;">'+(t||"出错了，请退出重新尝试~~~")+"</p></div></div>";if(!($("#toastProm").length>=1)){var r,s=e||1;r=1==s?n:2==s?i:o,$("body").append(r),a&&setTimeout(function(){$("#toastProm").remove()},a)}},webapp.closeLoading=function(){$("#toastProm").remove()},webapp.showIt=function(e,t){t=t||3e3,$("#"+e).show(),t&&setTimeout(function(){$("#"+e).hide()},t)},webapp.isFunction=function(e){return"function"==typeof e},webapp.session_id_key="PHPSESSID",webapp.get=function(e,t,a,n,i,o,r,s){return t=t||[],t._cuttag=apiConfig._cuttag,r=r||!1,i=i||"get",s=s||"vote",r&&("get"==i?(e="vote"==s?this.makeSign(e,t):this.wpMakeSign(e,t),t={}):e="vote"==s?this.makeSign(e):this.wpMakeSign(e)),e?void $.ajax({type:i,data:t,url:e,dataType:"json",async:o,timeout:15e3,success:function(e){if("function"!=typeof a)throw new Error("successFunc not a function");a(e)},error:function(e){"function"==typeof n&&n(e)}}):!1},webapp.makeSign=function(e,t){try{t=t||[];var a=this.getUrlParam(null,e);"string"==typeof a&&(a=[]);var n=this.randomStn(6),i=this.current_time(),o="r2n2uyactaw9tiniyk";a.session_id=this.getSessionId()||"",delete a._sign,delete t._sign;for(var r in a)t[r]=a[r];return t._sign=n+i+hex_sha1(n+o+i),e=e.split("?"),e[1]=this.ArrToUrlParam(t),e=e[0]+(""==e[1]?"":"?")+e[1]}catch(s){webapp.sign_num=webapp.sign_num||0;var p=setInterval(function(){webapp.sign_num++,webapp.sign_num<6?(clearInterval(p),webapp.makeSign(e,t)):(clearInterval(p),webapp.loading(3,"网络似乎存在问题，请刷新重新尝试~~~",3e3))},100)}},webapp.wpMakeSign=function(e,t){try{t=t||[];var a=this.getUrlParam(null,e);"string"==typeof a&&(a=[]),a._sign_nonce_str=this.randomStn(32),a._sign_time=this.current_time(),a.session_id=this.getSessionId()||"",delete a._sign,delete t._sign;for(var n in a)t[n]=a[n];var i="";for(var n in t)(""!=t[n]||"number"==typeof t[n])&&(""!=i&&(i+="&"),i+=n+"="+decodeURIComponent(t[n]));var o=i+"xsdsa9089sdfwe89u42342343213ds";return t._sign=hex_sha1(BASE64.encoder(o)),e=e.split("?"),e[1]=this.ArrToUrlParam(t),e=e[0]+(""==e[1]?"":"?")+e[1]}catch(r){webapp.sign_num=webapp.sign_num||0;var s=setInterval(function(){webapp.sign_num++,webapp.sign_num<6?(clearInterval(s),webapp.makeSign(e,t)):(clearInterval(s),webapp.loading(3,"网络似乎存在问题，请刷新重新尝试~~~",3e3))},100)}},webapp.randomStn=function(e,t){e=e||32,t=t||1;var a="ABCDEFGHJKMNPQROSTWXYLZabcdefhijkOlmnprstwxyz12345678",n=a.length,o="";for(i=0;e>i;i++)o+=a.charAt(Math.floor(Math.random()*n));return 2==t?"http://"+o:o},webapp.post=function(e,t,a,n,i,o,r){return this.get(e,t,a,n,"post",i,o,r)},webapp.getCheckboxValueByName=function(e){var t="";return $('input[name="'+e+'"]:checked').each(function(){t+=(""==t?"":",")+$(this).val()}),t},webapp.current_time=function(){return Date.parse(new Date)/1e3},webapp.getTimeLen=function(e,t){var a,n=e,i=this.current_time(),o=2==t?e:i-n;return t=t||1,a=1==t?"前":"后",result=60>o?o+"秒"+a:3600>o?parseInt(o/60)+"分钟"+a:86400>o?parseInt(o/3600)+"小时"+a:259200>o?parseInt(o/3600/24)+"天"+a:1==t?webapp.date("yyyy-MM-dd HH:mm:ss",e):parseInt(o/3600/24)+"天"+a},webapp.date=function(e,t){var a=new Date;if(a.setTime(1e3*t),!t)return"";var n=function(e,t){t||(t=2),e=new String(e);for(var a=0,n="";a<t-e.length;a++)n+="0";return n+e};return e.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|M{1,4}|yy(?:yy)?|([hHmstT])\1?|[lLZ])\b/g,function(e){switch(e){case"d":return a.getDate();case"dd":return n(a.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][a.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][a.getDay()];case"M":return a.getMonth()+1;case"MM":return n(a.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()];case"yy":return new String(a.getFullYear()).substr(2);case"yyyy":return a.getFullYear();case"h":return a.getHours()%12||12;case"hh":return n(a.getHours()%12||12);case"H":return a.getHours();case"HH":return n(a.getHours());case"m":return a.getMinutes();case"mm":return n(a.getMinutes());case"s":return a.getSeconds();case"ss":return n(a.getSeconds());case"l":return a.getMilliseconds();case"ll":return n(a.getMilliseconds());case"tt":return a.getHours()<12?"am":"pm";case"TT":return a.getHours()<12?"AM":"PM"}})},webapp.setCookie=function(e,t,a){a=a||30;var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3),document.cookie=e+"="+t+";expires="+n.toGMTString()+";path=/;"+(apiConfig.cookie_host?"domain="+apiConfig.cookie_host:"")},webapp.getCookie=function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?decodeURIComponent(t[2]):null},webapp.delCookie=function(e){var t=new Date;t.setTime(t.getTime()-1);var a=this.getCookie(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString())},webapp.cache=function(e,t,a){var n={};if(n.prefix="xsh_","string"!=typeof e||""==e)return null;if(e=n.prefix+e,void 0!=t)return null===t?(localStorage.removeItem(e),!0):(n.time=this.current_time(),n.expire=a,n.vaule=t,localStorage.setItem(e,JSON.stringify(n)),!0);if(n=window.localStorage.getItem(e)){n=JSON.parse(n);var i=webapp.current_time();return n.expire>0&&i-n.time>n.expire?(localStorage.removeItem(e),null):n.vaule}},webapp.timestamp=function(e,t){t=t||8;var a=Date.parse(new Date(e))-36e5*t;return a},webapp.datetimeToUnix=function(e){var t=e.replace(/:/g,"-");t=t.replace(/ /g,"-");var a=t.split("-"),n=new Date(Date.UTC(a[0],a[1]-1,a[2],a[3]-8,a[4]));return parseInt(n.getTime()/1e3)},webapp.isWeixin=function(){return/micromessenger(\/[\d\.]+)*/.test(navigator.userAgent.toLowerCase())},webapp.replaceStyle=function(e){return e.replace(/style=\"(.*)\"/,"")},webapp.wxLocation=function(e){wx.getLocation({type:"gcj02",success:function(t){window.localStorage.setItem("lat",t.latitude),window.localStorage.setItem("lng",t.longitude),"function"==typeof e&&e(1,t)},cancel:function(){alert("用户拒绝授权获取地理位置"),"function"==typeof e&&e(2)},fail:function(){"function"==typeof e&&e(2)}})},webapp.XshLocation={locationRes:{code:-1},errorMap:{NOT_SUPPORTED:"当前浏览器不支持GPS定位",PERMISSION_DENIED:"用户拒绝了定位请求",POSITION_UNAVAILABLE:"定位信息不可用",TIMEOUT:"定位超时",UNKNOWN_ERROR:"未知错误，无法定位"},enableLocation:function(){return!!navigator.geolocation},handleResult:function(e){if(e.code)switch(this.locationRes.code=0,e.code){case"NOT_SUPPORTED":this.locationRes.errorMsg=this.errorMap.NOT_SUPPORTED;break;case e.PERMISSION_DENIED:this.locationRes.errorMsg=this.errorMap.PERMISSION_DENIED;break;case e.POSITION_UNAVAILABLE:this.locationRes.errorMsg=this.errorMap.POSITION_UNAVAILABLE;break;case e.TIMEOUT:this.locationRes.errorMsg=this.errorMap.TIMEOUT;break;case e.UNKNOWN_ERROR:this.locationRes.errorMsg=this.errorMap.UNKNOWN_ERROR;break;default:this.locationRes.errorMsg="未知错误"}else this.locationRes.code=1,this.locationRes.data=e.coords,this.locationRes.data.timestamp=e.timestamp},startLocation:function(){var e=this;return this.enableLocation()?navigator.geolocation.getCurrentPosition(function(t){e.handleResult(t)},function(t){e.handleResult(t)}):e.handleResult({code:"NOT_SUPPORTED"}),this}},webapp.h5Location=function(e){var t=webapp.XshLocation.startLocation();1==t.locationRes.code?(lat=t.locationRes.data.latitude,lng=t.locationRes.data.longitude,qq.maps.convertor.translate(new qq.maps.LatLng(lat,lng,1,function(t){var a={};a.latitude=webapp.txTobd(t[0].lng,t[0].lat).lat,a.longitude=webapp.txTobd(t[0].lng,t[0].lat).lng,window.localStorage.setItem("lat",webapp.txTobd(t[0].lng,t[0].lat).lat),window.localStorage.setItem("lng",webapp.txTobd(t[0].lng,t[0].lat).lng),"function"==typeof e&&e(1,a)}))):$.get(location.protocol+"//api.xshapp.cn/v1/f/user/point",{},function(t){200==t.code&&(window.localStorage.setItem("lat",t.data.latitude),window.localStorage.setItem("lng",t.data.longitude),"function"==typeof e&&e(2,t))})},webapp.txTobd=function(e,t){var a={lat:"",lng:""};if(!e&&!t)return a;var n=52.35987755982988,i=e,o=t,r=Math.sqrt(i*i+o*o)+2e-5*Math.sin(o*n),s=Math.atan2(o,i)+3e-6*Math.cos(i*n),p=r*Math.cos(s)+.0065,c=r*Math.sin(s)+.006;return a={lat:c,lng:p}},webapp.trim=function(e){return e?e.replace(/<[^>]+>/g,""):""},webapp.countDownTime=function(e,t,a,n,i,o,r){function s(){if(c>0){c-=1,$("#"+o).css("display","inline").parents("#getPay").attr("pay","no");{var t,r=Math.floor(c/3600/24),s=Math.floor(c/3600%24),p=Math.floor(c/60%60),u=Math.floor(c%60);Math.floor(c%1e3/100)}r>=1?t=l+"<b>"+r+"</b>天<b>"+s+"</b>时<b>"+p+"</b>分<b>"+u+(1==e?"</b>秒":"</b>秒后&nbsp;开始"):s>=1?t=l+"<b>"+s+"</b>时<b>"+p+"</b>分<b>"+u+(1==e?"</b>秒":"</b>秒后&nbsp;开始"):p>=1?t=l+"<b>"+p+"</b>分<b>"+u+(1==e?"</b>秒":"</b>秒后&nbsp;开始"):u>=1&&(t=l+"<b>"+u+(1==e?"</b>秒":"</b>秒后&nbsp;开始")),o&&$("#"+o).css("display","none"),$("#"+i).html(t)}else 0==e?(clearInterval(d),a-n>0?o&&($("#"+i).remove(),$("#"+o).css("display","inline").parents("#getPay").attr("pay","yes")):$("#"+o).parents("#getPay").html("活动已结束").attr("pay","no")):1==e&&(c=a-n,l='<span class="line_feed">活动<b>结束</b>倒计时</span>',0>=c&&(clearInterval(d),$("#"+i).html("活动已结束")))}n=n||1;var p,c=t-n,l="";0==e?p="开始":99==r?l='<span class="line_feed">报名<b>截止</b>倒计时</span>':1==e&&99!=r&&(c>0?p="开始":(c=a-n,p="结束"),l='<span class="line_feed">活动<b>'+p+"</b>倒计时</span>","ad"==r&&(l="")),s();var d=setInterval(function(){s()},1e3)},webapp.scrollDistance=function(e,t){t=t||1;var a,n=1==t?window.screen.height:$(e).height(),i=1==t?$(e).height():$(e).find(".list-height").height();a="body"==e?webapp.getScrollTop():$(e).scrollTop();var o=i-(a+n);return o},webapp.getScrollTop=function(){var e;return window.pageYOffset?e=window.pageYOffset:document.compatMode&&"BackCompat"!=document.compatMode?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},webapp.lazyLoadImgS=function(e,t){t=t||"diy",webapp.lazyLoadImg=new LazyLoadImg({el:document.querySelector("#"+e),mode:t,time:300,complete:!0,position:{top:0,right:0,bottom:0,left:0},diy:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},before:function(){},success:function(){},error:function(){}})},webapp.clearPage=function(e){e=e||"list_page",localStorage.removeItem(e)},webapp.fenToYuan=function(e){return e=parseFloat(e)/100},webapp.setFoot=function(e,t){$("#"+e).css({position:"relative","margin-top":"10px"}),$(t.target).focus(function(){$("#"+e).css({position:"relative","margin-top":"10px"})}),$(t.target).blur(function(){$("#"+e).css("position","fixed")})},webapp.inputEnterHide=function(e,t){e.focus(function(){$("#"+t).css({display:"none"})}),e.blur(function(){setTimeout(function(){$("#"+t).removeAttr("style")},80)})},webapp.postShare=function(e,t){var a={};a={title:document_title||"小熊活动平台",url:e||location.href.split("#")[0],pid:0},a.share_type=t||1,1==a.share_type?a.pid=requestParams.goods_id||0:2==t&&requestParams.seller_uid?a.seller_uid=requestParams.seller_uid:2==t&&uid?a.seller_uid=uid:3==t&&(a.pid=requestParams.goods_id,a.vote_enterid=requestParams.enter_id),page.apiPost("/Index/VoteStatic/addProductShares",a,function(e){0==e.code&&webapp.GetRequest().goods_id&&$("#share_num").html(e.data.share_num)})},webapp.addType=function(e){var t='<div class="weui-skin_android" id="release_content"><div class="weui-mask hideSType"></div><div class="weui-dialog weui-skin_android p-ten"><svg class="abs icon shut-icon hideSType" aria-hidden="true"><use xlink:href="#icon-cha"></use></svg><div class="m-t-ten m-b-ten text-center"><p class="size-16">想发布什么活动呢？</p></div><div style="padding: 20px;"> <a href="/Index/Goods/edit?t_id='+e+"&editType=2"+(provider_tag?"&provider_tag="+provider_tag:"")+'" class="m-b-ten weui-btn weui-btn_plain-primary size-15">砍价活动</a> <a href="/Index/Goods/edit?t_id='+e+"&editType=3"+(provider_tag?"&provider_tag="+provider_tag:"")+'" class="m-b-ten weui-btn weui-btn_plain-primary size-15">拼团活动</a> <a href="/Index/Goods/edit?t_id='+e+"&editType=1"+(provider_tag?"&provider_tag="+provider_tag:"")+'" class="weui-btn weui-btn_plain-primary size-15">团购秒杀</a> </div></div></div>';$("body").append(t),$(".hideSType").click(function(){$("#release_content").remove()})},webapp.uninScroll=function(e,t){function a(){var a=$("#"+e);a.animate({"margin-top":-t.lHeight+"px"},t.gtime,function(){a.css({"margin-top":"0px"}).find("li:first").appendTo(a)})}var n;t.lHeight=t.lHeight||24,t.gtime=t.gtime||800,t.ttime=t.ttime||3e3,n=setInterval(function(){a()},t.ttime)},webapp.generateImage=function(e,t,a){var n=$("#"+e),i=n.width(),o=n.height(),r=document.createElement("canvas");a=a||1,r.width=3*i,r.height=3*o,r.background="#fffff",r.style.width=i+"px",r.style.height=o+"px";var s=r.getContext("2d");s.scale(3,3),html2canvas(n,{allowTaint:!1,taintTest:!0,canvas:r,onrendered:function(e){var i=e.toDataURL("image/png").replace("image/png","image/octet-stream"),o='<img src="'+i+'">';$("#"+t).html(o),1==a&&n.remove()}})},webapp.listCountDownTime=function(e,t){function a(){for(var t in e){var a=--e[t].lTime;if(0>=a)$("#"+e[t].id).html("活动已结束");else{var n=parseInt(a/60/60/24),i=parseInt(a/60/60%24),o=parseInt(a/60%60),r=parseInt(a%60),s=n+"天"+i+"小时"+o+"分钟"+r+"秒";$("#"+e[t].id).html(s)}}}if(e=e||"","first"==t){setInterval(function(){a()},1e3)}},webapp.addDisabled=function(e,t){t=t||1,e&&(1==t?$("#"+e).attr("disabled",!0):$("#"+e).removeAttr("disabled"))},webapp.confirm=function(e){var t=document.createElement("IFRAME");t.style.display="none",t.setAttribute("src","data:text/plain,"),document.documentElement.appendChild(t);var a=window.frames[0],n=a.window.confirm(e);return t.parentNode.removeChild(t),n},webapp.wxPay=function(e,t,a){t.apiPostUrl=t.apiPostUrl||"/Index/Mppay/applyWxJsPay",t.goods_id=t.goods_id||webapp.GetRequest().goods_id||"",page.apiPost(t.apiPostUrl,e,function(e){0==e.code?e.data.pay_sn?(e.data.pay.appId&&e.data.config.appId||webapp.postError("微信支付(wxPay)出错，缺少appid：",JSON.stringify(e.data),location.href,1),webapp.wxCall(e.data,t,e.data.pay_sn,a),t.goods_id&&page.get("/Index/Index/clearGoodsCache",{id:t.goods_id})):(webapp.closeLoading(),webapp.loading(3,"订单无效，请刷新重试~~~",2e3)):(webapp.closeLoading(),webapp.loading(3,e.msg,2e3))},function(e){0==e.readyState?webapp.loading(3,"太快了，还没准备好，请稍后重试！",2e3):(webapp.postError("微信支付(wxPay)出错："+JSON.stringify(e),JSON.stringify(e),location.href,1),webapp.closeLoading(),webapp.loading(3,"出错了，请刷新后重试",2e3),webapp.success(2,t.cancel_url||"/Index/User/myOrder?type=1"+(provider_tag?"&provider_tag="+provider_tag:"")))})},webapp.wxCall=function(e,t,a,n){wx.chooseWXPay({timestamp:webapp.trim(e.pay.timeStamp),nonceStr:webapp.trim(e.pay.nonceStr),"package":webapp.trim(e.pay.package),signType:webapp.trim(e.pay.signType),paySign:webapp.trim(e.pay.paySign),success:function(){if(3==t.order_type&&"function"==typeof n)webapp.closeLoading(),n({code:0});else if(2==t.order_type)webapp.closeLoading(),webapp.loading(2,t.prompt_word||"支付成功",2e3),webapp.success(2,t.success_url);else var e=0,i=setInterval(function(){50>e?(e+=1,page.apiGet("/Index/Mporder/chkWxPayOrderStatus",{pay_sn:a},function(e){0==e.code?window.location.href=t.success_url:2011==e.code&&(clearInterval(i),webapp.closeLoading(),webapp.loading(3,"支付超时，请重新购买进行支付~~~",2e3),setTimeout(function(){location.reload()},1800))},function(){clearInterval(i),webapp.closeLoading(),webapp.loading(3,"出错了，请刷新后重试",2e3)})):(clearInterval(i),webapp.closeLoading(),webapp.loading(3,"支付超时，请退出重试~~~",2e3))},1e3)},fail:function(a){webapp.postError("微信支付出错："+JSON.stringify(a),JSON.stringify(a)+JSON.stringify(e),location.href,1),webapp.closeLoading(),webapp.loading(3,"不好意思！支付获取失败，快联系技术帮你解决吧！微信号：xiongtao720，欢迎来反馈",5e3),webapp.success(1,t.cancel_url||"/Index/User/myOrder?type=1"+(provider_tag?"&provider_tag="+provider_tag:""))},cancel:function(){webapp.closeLoading(),window.location.href=t.cancel_url||"/Index/User/myOrder?type=1"+(provider_tag?"&provider_tag="+provider_tag:"")}})},webapp.wxPcOrMobile=function(){var e=/macintosh|window/.test(navigator.userAgent.toLowerCase());return e},webapp.iosOrAndroid=function(){var e=navigator.userAgent,t=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1,!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/));return t},webapp.postError=function(e,t,a,n){a=a||location.href,e=e||document_title,n=n||0;var i="错误信息：\n当前URL："+location.href+"\n错误详情："+t+"\n客户端版本:"+navigator.appCodeName+"\n"+navigator.appVersion||"错误信息：\n当前URL："+location.href+"\n错误详情："+JSON.stringify(res)+"\n客户端版本:"+navigator.appCodeName+"\n"+navigator.appVersion;page.apiPost("/Index/VoteLog/addJsLog",{content:i,title:e,url:a,wxmsg_tag:n})},webapp.againSignature=function(){var e=!1;return window.__wx_is_share?e=!0:(webapp.loading(3,"微信签名未通过,重新签名中,请稍后重试~~",2e3),share.start(),e)},webapp.getDetailsUrl=function(e,t,a){var n,i,o="",r="";if(t=t||{},a=a||1,o=apiConfig.info_name,t)for(var s in t)r+="&"+s+"="+t[s];i=e,goodsIdArr[e]&&(i=goodsIdArr[e]);var p=document.location.protocol,c=webapp.randomStn(8,2)+apiConfig.cookie_host+o+"?goods_id="+e+r+"&randomStr="+webapp.randomStn(32);return n=2==a&&"PRODUCT"==apiConfig.CONF_KEY?apiConfig.share_url?webapp.randomStn(8,2)+apiConfig.share_url+apiConfig.shareControllers+"?url="+encodeURIComponent(c):c:"PRODUCT"==apiConfig.CONF_KEY?webapp.randomStn(8,2)+apiConfig.cookie_host+o+"?goods_id="+e+r+"&randomStr="+webapp.randomStn(32):p+"//vote"+apiConfig.cookie_host+o+"?goods_id="+e+r+"&randomStr="+webapp.randomStn(32)},webapp.getBuyUrl=function(e,t,a,n){var i,o,r="";if(n=n||1,t)for(var s in t)r+="&"+s+"="+t[s];return o=4==a?apiConfig.giftPage:apiConfig.eggPage,i=apiConfig.front_url+"Index/Buy/"+o+"?goods_id="+e+r,2!=n?i:void(location.href=i)},webapp.scrollGetJs=function(e,t,a){a=a||2;var n=document.getElementById(e).offsetTop,i=document.getElementById(e).offsetHeight,o=document.documentElement.clientHeight||document.body.offsetHeight,r=webapp.getScrollTop();t(r>n+i||n>r+o*a?!1:!0)},webapp.eachInput=function(e){var t={};return $(e).each(function(){this.type=$(this).attr("type"),this.types=$(this).attr("types")||"",this.name=$(this).attr("name"),this.val=$(this).val(),"text"==this.type||"number"==this.type||"tel"==this.type?(t[this.name]="time"==this.types?webapp.datetimeToUnix(this.val):this.val,$(this).val($(this).val())):"checkbox"==this.type?t[this.name]=$(this).is(":checked")?1:0:"textarea"==this.type?t[this.name]=this.value:"html"==this.type&&(t[this.name]=$(this).html())}),t},webapp.setHref=function(e){$(e.target).attr("href",$(e.target).text())},webapp.saveExcel=function(){var e={};e.fileName=window.jsonExcelData.fileName,e.datas=[{sheetHeader:window.jsonExcelData.sheetHeader,sheetData:window.jsonExcelData.sheetData},{sheetData:window.jsonExcelData.sheetData}];var t=new ExportJsonExcel(e);t.saveExcel()},webapp.getBase64Image=function(e,t,a){var n=document.createElement("CANVAS"),i=n.getContext("2d"),o=new Image;o.crossOrigin="Anonymous",o.onload=function(){n.height=o.height,n.width=o.width,i.drawImage(o,0,0);var e=n.toDataURL(a||"image/png");t.call(this,e),n=null},o.src=e},webapp.escape2Html=function(e){var t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,a){return t[a]})},webapp.theTimer=function(e,t){e=e||2,setTimeout(function(){"function"==typeof t?t():location.reload()},1e3*e)},webapp.pasteHtmlAtCaret=function(e){var t,a;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt&&t.rangeCount){a=t.getRangeAt(0),a.deleteContents();var n=document.createElement("div");n.innerHTML=e;for(var i,o,r=document.createDocumentFragment();i=n.firstChild;)o=r.appendChild(i);a.insertNode(r),o&&(a=a.cloneRange(),a.setStartAfter(o),a.collapse(!0),t.removeAllRanges(),t.addRange(a))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(e)};
;/*!static/lib/load-img.js*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoadImg=e()}(this,function(){"use strict";var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getBoundingClientRect(),o=t.offsetWidth,r=t.offsetHeight,i=window.innerWidth,a=window.innerHeight,s=!(n.right-e.left<=0&&n.left+o-e.left<=0||n.left+e.right>=i&&n.right+e.right>=o+i),u=!(n.bottom-e.top<=0&&n.top+r-e.top<=0||n.top+e.bottom>=a&&n.bottom+e.bottom>=r+a);return 0!==t.width&&0!==t.height&&s&&u},e=document.createElement("canvas");e.getContext("2d").globalAlpha=0;var n={},o=function(t,o,r){if(n[t])return n[t];e.width=o,e.height=r;var i=e.toDataURL("image/png");return n[t]=i,i},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},s=window,u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=window.innerHeight;r(this,e),this.options={el:document.querySelector("body"),mode:"default",time:300,done:!0,diy:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},position:{top:-n,right:0,bottom:-n,left:0},before:function(){},success:function(){},error:function(){}},t.position=this.options.position,t.diy=a({},this.options.diy,t.diy),a(this.options,t),this.start()}return i(e,[{key:"start",value:function(){this._timer=!0,this._start()}},{key:"_start",value:function(){var e=this,n=this.options;clearTimeout(this._timer),this._timer&&(this._timer=setTimeout(function(){if(!n.el)return clearTimeout(e._timer);var o=Array.prototype.slice.apply(n.el.querySelectorAll("[data-src]"));return!o.length&&n.done?clearTimeout(e._timer):(o.forEach(function(o){!o.dataset.LazyLoadImgState&&t(o,n.position)&&e.loadImg(o)}),void e._start())},n.time))}},{key:"loadImg",value:function(t){var e=this,n=this.options;n.before.call(this,t);var r=new s.Image;r.src=t.dataset.src,r.addEventListener("load",function(){return"diy"===n.mode?(t.src=o(t.src,t.width,t.height),n.diy.backgroundImage="url("+r.src+")",a(t.style,n.diy)):t.src=r.src,t.dataset.src&&delete t.dataset.src,t.dataset.LazyLoadImgState&&delete t.dataset.LazyLoadImgState,n.success.call(e,t)},!1),r.addEventListener("error",function(){delete t.dataset.src,delete t.dataset.LazyLoadImgState,n.error.call(e,t)},!1)}},{key:"destroy",value:function(){delete this._timer}}]),e}();return u});
;/*!static/lib/page.js*/
!function(t){window.page=t()}(function(){var t={};return t.isChkLogin=!0,t.is_show_loading=!1,t.showLoad=function(t){return this.is_show_loading=t,this},t.userUser=null,t.apiGet=function(o,i,n,e,s){t.get((apiConfig.api_url||"")+o,i,n,e,!0,!0,s)},t.apiPost=function(o,i,n,e,s){webapp.post(apiConfig.api_url+o,i,function(o){t.isChkLogin&&t.doChkLogin(o),"function"==typeof n&&n(o)},e,!0,!0,s)},t.get=function(o,i,n,e,s,a,p){webapp.get(o,i,function(o){t.isChkLogin&&t.doChkLogin(o),"function"==typeof n&&n(o)},e,"get",s,a,p)},t.post=function(o,i,n,e,s,a,p){webapp.post(o,i,function(o){t.isChkLogin&&t.doChkLogin(o),"function"==typeof n&&n(o)},e,s,a,p)},t.getPtRouterPathInfo=function(){var t;return t=location.hash.indexOf("?")<0?location.hash:location.hash.substr(0,location.hash.indexOf("?")),t=t.split("/"),t.splice(0,1),t},t.doChkLogin=function(t){if(20009==t.code){webapp.loading(1,"正在登陆~~~");var o="/Index/wx/wxLogin?url="+encodeURIComponent(location.href);window.top!==window.self?window.top.location=o:window.location.href=o}},t.session_id="PHPSESSID",t.init=function(o){t.session_id=webapp.getSessionId()||"",this.apiGet("/Index/Index/gitServerConfig",{},function(i){t.session_id=i.session_id,0==i.code&&(ServerConfig.api=i.data),console.log(i),t.session_id&&webapp.setSessionId(t.session_id),webapp.isFunction(o)&&o(i)})},t.setWebTitle=function(t){t&&""!=t||(t=""),$("title").text(t)},t.getRequestHash=function(o){t.apiGet("/Index/Hash/createHash",{},function(t){try{o(t)}catch(i){webapp.error("不好意思，发生异常啦！")}})},"function"==typeof Vue&&Vue.filter("timeFormat",function(t,o){return webapp.date(o,t)}),t.enPassword=function(t,o){return hex_sha1(BASE64.encoder(t)+o)},t.restTipso=function(t,o,i){t=$(t).tipso({position:"right"}),t.tipso("update","content",o||t.attr("tip-text")||""),t.tipso("update","background",i||"#999")},t.logout=function(){this.apiGet("/Index/Login/logout",{},function(t){0==t.code&&(location.href="/login.html")})},t.ValidForm=function(o,i,n){return n=n||"doSubmit",$(o).attr("valid-init")?!1:($(o+" > [tip-text]").each(function(){var o=$(this).attr("tip-text");o&&t.restTipso(this,o)}),$(o).ValidForm({showAllError:!1,callback:i,btnSubmit:$(o).find("#"+n),tiptype:function(o,i){var n=$(i.obj),e=n.parents(".form-group").find(">label").text();if(console.log(i),console.log(o),e=e||"",2==i.type)n.tipso("hide"),t.restTipso(n);else if(3==i.type){var s=e+"无效"+o+(n.attr("tip-text")?":"+n.attr("tip-text"):"");n.tipso("close"),n.tipso("destroy"),n.tipso("update","background","#D63939").tipso("update","position","right").tipso("update","content",s).tipso("show")}}}),void $(o).attr("valid-init",!0))},t});
;/*!static/lib/wxShare.js*/
var share={wx:"",url:"",link:"",title:"",desc:"",imgUrl:"",type:"",dataUrl:"",latitude:"",longitude:"",name:"",address:"",infoUrl:"",scale:14,share_type:1,data:"",QQData:"",TimeLineData:"",WeiBoData:"",Location:"",url_type:1,url_title:document_title,url_refer:document.referrer||location.href.split("#")[0],share_get_num:0,getMPShareNum:0,success:function(){webapp.postShare(share.link,share.share_type)},cancel:function(){},setData:function(){var e=this;e.data={title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,type:e.type,dataUrl:e.dataUrl,scale:14,latitude:e.latitude,longitude:e.longitude,name:e.name,address:e.address,infoUrl:e.infoUrl,success:e.success,cancel:e.cancel},e.QQData=JSON.stringify(e.data),e.QQData=JSON.parse(e.QQData),e.TimeLineData=JSON.stringify(e.data),e.TimeLineData=JSON.parse(e.TimeLineData),e.WeiBoData=JSON.stringify(e.data),e.WeiBoData=JSON.parse(e.WeiBoData),e.Location=JSON.stringify(e.data),e.Location=JSON.parse(e.Location),e.QQData.success=e.success,e.TimeLineData.success=e.success,e.WeiBoData.success=e.success,e.Location.success=e.success,e.QQData.cancel=e.cancel,e.TimeLineData.cancel=e.cancel,e.WeiBoData.cancel=e.cancel,e.Location.cancel=e.cancel},start:function(){var e=this,a={};a.share_url=e.url,a.url_type=e.url_type,a.url_title=e.url_title,a.url_refer=e.url_refer,3==a.url_type?(a.tag=requestParams.enter_id,isNaN(requestParams.goods_id)||(a.product_id=requestParams.goods_id)):2==a.url_type&&(a.tag=requestParams.goods_id),page.apiPost("/Index/Wx/getVoteShare",a,function(t){if(0==t.code){if(window._time=t._time,e.wxAPI(t.data.appId,t.data.timestamp,t.data.nonceStr,t.data.signature),3==a.url_type||2==a.url_type){var n=parseInt($("#user_unreal_num").val()),s=parseInt($("#unreal_hitsnum").val()),i=parseInt(t.data.extends.hits_num),r=parseInt(t.data.extends.share_num);if(3==a.url_type){var o=parseInt($("#user_unreal_num").attr("unreal_share_num"));$("#view_num").html(i+n),$("#view_num_input").val(i+n),$("#share_num").html(r+o)}else 2==a.url_type&&($("#unreal_hitsnum").length>0?($("#view_num").html(i+s),$("#view_num_input").val(i+s)):($("#view_num").html(i),$("#view_num_input").val(i)),$("#share_num").html(r))}}else e.getMPShareNum<3?(e.getMPShareNum++,e.start()):(webapp.loading(3,"签名失败，请刷新重新尝试~~~",1500),webapp.postError("获取签名3次失败",t.msg))})},wxAPI:function(e,a,t,n){var s=this;this.wx.config({debug:!1,appId:e,timestamp:a,nonceStr:t,signature:n,jsApiList:["chooseWXPay","checkJsApi","scanQRCode","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","translateVoice","openLocation","getLocation","geoLocation","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","chooseImage","previewImage","uploadImage","downloadImage","favorite"]}),this.wx.checkJsApi({jsApiList:["chooseImage","chooseWXPay"],success:function(e){!e.checkResult.chooseImage,!e.checkResult.chooseWXPay}}),this.wx.ready(function(){s.wx.hideMenuItems({menuList:["menuItem:copyUrl","menuItem:share:email"]});for(var e in window.wxCallbackList)webapp.isFunction(window.wxCallbackList[e])&&(window.wxCallbackList[e](),window.wxCallbackList.splice(e,1));window.__wx_is_share=!0,""==s.data&&s.setData(),s.wx.onMenuShareQQ(s.QQData),s.wx.onMenuShareAppMessage(s.data),s.wx.onMenuShareTimeline(s.TimeLineData),s.wx.onMenuShareWeibo(s.WeiBoData),s.latitude&&s.wx.openLocation(s.Location),s.wx.hideMenuItems({menuList:["menuItem:readMode","menuItem:openWithQQBrowser","menuItem:setFont","menuItem:exposeArticle"],success:function(){},fail:function(){}})}),this.wx.error(function(e){window.__wx_is_share=!1,s.share_get_num<3?(s.share_get_num++,s.start()):webapp.postError("微信签名连续失败",JSON.stringify(e))})}};